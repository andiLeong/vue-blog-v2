import{B as k}from"./BaseInput.9035ddc1.js";import{x as p,u as w,a as d,d as l,b as e,h,f,t as m,F as L,e as V,i as c,p as B,c as b,k as I,o as n}from"./vendor.47665e28.js";import{N as S,T as N}from"./Tiptap.b622e5f5.js";import{L as j}from"./LoadingIndicator.9eb9df3d.js";import{_ as C}from"./index.194b9bcf.js";class D{constructor(){this.errors={}}has(t){return this.errors.hasOwnProperty(t)}any(){return Object.keys(this.errors).length>0}get(t){if(this.errors[t])return this.errors[t][0]}record(t){this.errors=t}clear(t){if(t){delete this.errors[t];return}this.errors={}}}class F{constructor(t){this.originalData=t;for(let i in t)this[i]=t[i];this.errors=new D}data(){let t={};for(let i in this.originalData)t[i]=this[i];return t}reset(){for(let t in this.originalData)this[t]="";this.errors.clear()}post(t){return this.submit("post",t)}put(t){return this.submit("put",t)}patch(t){return this.submit("patch",t)}delete(t){return this.submit("delete",t)}submit(t,i){return new Promise((u,s)=>{p[t](i,this.data()).then(a=>{this.onSuccess(a.data),u(a.data)}).catch(a=>{this.onFail(a.response.data),s(a.response.data)})})}onSuccess(t){this.reset()}onFail(t){this.errors.record(t)}}const T={components:{BaseInput:k,Notification:S,Tiptap:N,LoadingIndicator:j},data(){return{form:new F({title:"",body:""}),errors:{},isLoading:!1,submitted:!1,useStore:w()}},methods:{store(){this.isLoading=!0,p.post("/api/posts",this.form).then(o=>{this.form.title=this.form.body="",this.isLoading=!1,this.submitted=!0}).catch(o=>{this.isLoading=!1;let t=o.response.status;if(t=="401")return this.useStore.dispatch("logout"),router.push({name:"login"});if(t=="403"||t=="401")return alert(o.response.data.message);this.errors=o.response.data.errors,console.log(o.response.data.errors)}),this.submitted=!1}}},E={class:"space-y-8 divide-y divide-gray-200"},O={class:"mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6"},P={class:"sm:col-span-4"},U={class:"sm:col-span-4"},Y=e("label",{for:"about",class:"block text-sm font-medium text-gray-700 dark:text-white"}," About ",-1),z=e("p",{class:"mt-2 text-sm text-gray-500 dark:text-white"}," Describe the post ",-1),A={class:"pt-5"},H={class:"mb-2"},K={class:"flex justify-start"},M=["disabled"];function W(o,t,i,u,s,a){const g=d("BaseInput"),y=d("tiptap"),_=d("LoadingIndicator"),x=d("Notification");return n(),l("form",{onSubmit:t[2]||(t[2]=I((...r)=>a.store&&a.store(...r),["prevent"])),onKeydown:t[3]||(t[3]=r=>s.form.errors.clear(r.target.name)),class:"space-y-8 divide-y divide-gray-200 my-10 mb-10 max-w-7xl mx-auto px-6"},[e("div",E,[e("div",null,[e("div",O,[e("div",P,[h(g,{labelClass:"block text-sm font-medium text-gray-700 dark:text-white",placeHolder:"Wite a nice title",class:"mt-1 shadow-sm focus:ring-sky-500 focus:border-sky-500 block w-full sm:text-sm border-gray-300 rounded-md",label:"Title",type:"text",modelValue:s.form.title,"onUpdate:modelValue":t[0]||(t[0]=r=>s.form.title=r),error:s.form.errors.get("title")},null,8,["modelValue","error"])]),e("div",U,[f(m(s.form.body)+" ",1),Y,z,h(y,{modelValue:s.form.body,"onUpdate:modelValue":t[1]||(t[1]=r=>s.form.body=r)},null,8,["modelValue"])])])])]),e("div",A,[e("div",H,[s.errors?(n(!0),l(L,{key:0},V(s.errors,(r,v)=>(n(),l("p",{class:"mt-1 text-sm text-red-500 italic",key:v},m(r[0]),1))),128)):c("",!0)]),e("div",K,[e("button",{type:"submit",disabled:s.isLoading,class:B([{"cursor-not-allowed ":s.isLoading},"primary-btn"])},[s.isLoading?(n(),b(_,{key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white"})):c("",!0),f(" "+m(s.isLoading?"Saving In":"Save"),1)],10,M),s.submitted?(n(),b(x,{key:0,timeout:"1000",body:"Your post had been submitted",footer:"You can view it now."})):c("",!0)])])],32)}var X=C(T,[["render",W]]);export{X as default};
