import{a2 as v,o as i,d,b as l,t as p,p as X,k as P,f as h,x as L,a as O,h as w,F as _,i as m,e as Y,c as Q}from"./vendor.47665e28.js";import{_ as C}from"./index.194b9bcf.js";var Z={baseURL:"",maxConcurrentUploads:2},c={WAITING:0,UPLOADING:1,FAILED:2,UNSUPPORTED:3,COMPLETE:4,CANCELLED:5},ee="Expected a function",R="__lodash_hash_undefined__",A=1/0,te="[object Function]",re="[object GeneratorFunction]",ne="[object Symbol]",se=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ae=/^\w*$/,oe=/^\./,ie=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,le=/[\\^$.*+?()[\]{}|]/g,de=/\\(\\)?/g,ce=/^\[object .+?Constructor\]$/,ue=typeof v=="object"&&v&&v.Object===Object&&v,pe=typeof self=="object"&&self&&self.Object===Object&&self,F=ue||pe||Function("return this")();function he(e,t){return e==null?void 0:e[t]}function fe(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch{}return t}var ge=Array.prototype,_e=Function.prototype,G=Object.prototype,N=F["__core-js_shared__"],M=function(){var e=/[^.]+$/.exec(N&&N.keys&&N.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),$=_e.toString,S=G.hasOwnProperty,q=G.toString,me=RegExp("^"+$.call(S).replace(le,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),V=F.Symbol,ye=ge.splice,be=B(F,"Map"),b=B(Object,"create"),H=V?V.prototype:void 0,z=H?H.toString:void 0;function f(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ve(){this.__data__=b?b(null):{}}function Ce(e){return this.has(e)&&delete this.__data__[e]}function xe(e){var t=this.__data__;if(b){var r=t[e];return r===R?void 0:r}return S.call(t,e)?t[e]:void 0}function Ue(e){var t=this.__data__;return b?t[e]!==void 0:S.call(t,e)}function Ee(e,t){var r=this.__data__;return r[e]=b&&t===void 0?R:t,this}f.prototype.clear=ve;f.prototype.delete=Ce;f.prototype.get=xe;f.prototype.has=Ue;f.prototype.set=Ee;function y(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function De(){this.__data__=[]}function Pe(e){var t=this.__data__,r=x(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():ye.call(t,r,1),!0}function Le(e){var t=this.__data__,r=x(t,e);return r<0?void 0:t[r][1]}function Oe(e){return x(this.__data__,e)>-1}function we(e,t){var r=this.__data__,n=x(r,e);return n<0?r.push([e,t]):r[n][1]=t,this}y.prototype.clear=De;y.prototype.delete=Pe;y.prototype.get=Le;y.prototype.has=Oe;y.prototype.set=we;function g(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Fe(){this.__data__={hash:new f,map:new(be||y),string:new f}}function Ne(e){return U(this,e).delete(e)}function Se(e){return U(this,e).get(e)}function Ie(e){return U(this,e).has(e)}function Te(e,t){return U(this,e).set(e,t),this}g.prototype.clear=Fe;g.prototype.delete=Ne;g.prototype.get=Se;g.prototype.has=Ie;g.prototype.set=Te;function x(e,t){for(var r=e.length;r--;)if(ze(e[r][0],t))return r;return-1}function ke(e,t){t=Ge(t,e)?[t]:Ae(t);for(var r=0,n=t.length;e!=null&&r<n;)e=e[Ve(t[r++])];return r&&r==n?e:void 0}function je(e){if(!W(e)||$e(e))return!1;var t=Be(e)||fe(e)?me:ce;return t.test(He(e))}function Re(e){if(typeof e=="string")return e;if(T(e))return z?z.call(e):"";var t=e+"";return t=="0"&&1/e==-A?"-0":t}function Ae(e){return K(e)?e:qe(e)}function U(e,t){var r=e.__data__;return Me(t)?r[typeof t=="string"?"string":"hash"]:r.map}function B(e,t){var r=he(e,t);return je(r)?r:void 0}function Ge(e,t){if(K(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||T(e)?!0:ae.test(e)||!se.test(e)||t!=null&&e in Object(t)}function Me(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function $e(e){return!!M&&M in e}var qe=I(function(e){e=We(e);var t=[];return oe.test(e)&&t.push(""),e.replace(ie,function(r,n,s,a){t.push(s?a.replace(de,"$1"):n||r)}),t});function Ve(e){if(typeof e=="string"||T(e))return e;var t=e+"";return t=="0"&&1/e==-A?"-0":t}function He(e){if(e!=null){try{return $.call(e)}catch{}try{return e+""}catch{}}return""}function I(e,t){if(typeof e!="function"||t&&typeof t!="function")throw new TypeError(ee);var r=function(){var n=arguments,s=t?t.apply(this,n):n[0],a=r.cache;if(a.has(s))return a.get(s);var u=e.apply(this,n);return r.cache=a.set(s,u),u};return r.cache=new(I.Cache||g),r}I.Cache=g;function ze(e,t){return e===t||e!==e&&t!==t}var K=Array.isArray;function Be(e){var t=W(e)?q.call(e):"";return t==te||t==re}function W(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function Ke(e){return!!e&&typeof e=="object"}function T(e){return typeof e=="symbol"||Ke(e)&&q.call(e)==ne}function We(e){return e==null?"":Re(e)}function Je(e,t,r){var n=e==null?void 0:ke(e,t);return n===void 0?r:n}var Xe=Je,E,Ye=new Uint8Array(16);function Qe(){if(!E&&(E=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!E))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return E(Ye)}var Ze=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function et(e){return typeof e=="string"&&Ze.test(e)}var o=[];for(var k=0;k<256;++k)o.push((k+256).toString(16).substr(1));function tt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]).toLowerCase();if(!et(r))throw TypeError("Stringified UUID is invalid");return r}function rt(e,t,r){e=e||{};var n=e.random||(e.rng||Qe)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(var s=0;s<16;++s)t[r+s]=n[s];return t}return tt(n)}const nt={data(){return{dragging:!1,draggingCount:0}},methods:{handleFilesChosen(e){this.dragging=!1,this.$emit("chosen",e.target.files)},handleDragOver(e){this.dragging=!0,this.draggingCount=e.dataTransfer.items.length},handleDragLeave(){this.dragging=!1,this.draggingCount=0}}},st={key:0,class:"text-gray-700"},at=h(" Nearly there. Let go to upload "),ot={class:"font-medium"},it=h(" items! "),lt={key:1,class:"text-gray-700"},dt=h(" Drop here to upload or "),ct=l("span",{class:"text-sky-500"},"choose files",-1),ut=[dt,ct];function pt(e,t,r,n,s,a){return i(),d("form",{enctype:"multipart/form-data",novalidate:"",class:X(["bg-gray-200 border-gray-400 border-2 border-dashed rounded-lg p-10 flex items-center justify-center mb-6 relative",{"border-gray-600":s.dragging}]),onDragover:t[1]||(t[1]=P((...u)=>a.handleDragOver&&a.handleDragOver(...u),["prevent"])),onDragleave:t[2]||(t[2]=P((...u)=>a.handleDragLeave&&a.handleDragLeave(...u),["prevent"]))},[l("input",{type:"file",multiple:"",class:"absolute opacity-0 w-full h-full top-0 left-0",onChange:t[0]||(t[0]=(...u)=>a.handleFilesChosen&&a.handleFilesChosen(...u))},null,32),s.dragging?(i(),d("div",st,[at,l("span",ot,p(s.draggingCount),1),it])):(i(),d("div",lt,ut))],34)}var ht=C(nt,[["render",pt]]);const ft={props:{progress:{required:!0,type:Number}},data(){return{radius:54}},computed:{dash(){return 2*Math.PI*this.radius},offset(){let e=this.dash,t=this.progress/100;return e*(1-t)}}},gt={class:"h-20 w-20 mr-6 relative"},_t={class:"absolute inset-0 flex items-center justify-center"},mt={class:"text-blue-500 text-sm font-medium leading-tight"},yt={class:"-rotate-90",viewBox:"0 0 120 120"},bt=["r"],vt=["r","stroke-dasharray","stroke-dashoffset"];function Ct(e,t,r,n,s,a){return i(),d("div",gt,[l("div",_t,[l("span",mt,p(r.progress)+"% ",1)]),(i(),d("svg",yt,[l("circle",{cx:"60",cy:"60",r:s.radius,fill:"none","stroke-width":"12",class:"stroke-current text-gray-200"},null,8,bt),l("circle",{cx:"60",cy:"60",r:s.radius,fill:"none","stroke-width":"12",class:"stroke-current text-blue-500","stroke-dasharray":a.dash,"stroke-dashoffset":a.offset},null,8,vt)]))])}var xt=C(ft,[["render",Ct]]);const Ut={components:{UploaderProgress:xt},props:{upload:{required:!0,type:Object},baseURL:{required:!0,type:String},endpoint:{required:!0}},data(){return{state:null,progress:0,axios:{cancel:null},states:c}},computed:{sizeDisplay(){return(this.upload.file.size/1e6).toFixed(2)}},watch:{"upload.queued"(e){this.state!==c.UNSUPPORTED&&e===!1&&this.startUpload()},progress(e){this.$emit("progress",{id:this.upload.id,progress:e})},state(e){switch(this.$emit("change",{id:this.upload.id,state:e}),e){case c.CANCELLED:case c.FAILED:this.progress=0;break}}},methods:{cancel(){this.axios.cancel()},makeFormData(e){const t=new FormData;return t.append("file",e,e.name),t.append("last_modified",e.lastModified),t.append("fileable_id",1),t.append("fileable_type","Gallery"),console.log("submit data is   ::  "+JSON.stringify(t)),t},handleUploadProgress(e){this.progress=Math.round(e.loaded*100/e.total)},startUpload(){this.state=c.UPLOADING,L.post(this.endpoint,this.makeFormData(this.upload.file),{baseURL:this.baseURL,onUploadProgress:this.handleUploadProgress,cancelToken:new L.CancelToken(e=>{this.axios.cancel=e})}).then(()=>{this.state=c.COMPLETE}).catch(e=>{if(e instanceof L.Cancel)return this.state=c.CANCELLED;this.state=c.FAILED})}},mounted(){if(this.endpoint===null)return this.state=c.UNSUPPORTED;this.state=c.WAITING}},Et={class:"bg-white rounded-lg p-4 flex items-stretch mb-1"},Dt={class:"flex flex-col justify-between"},Pt={class:"mb-2"},Lt={class:"font-medium mr-3 text-gray-700 leading-tight"},Ot={class:"text-gray-600 text-sm leading-tight"},wt={class:"text-gray-600 text-sm align-baseline"},Ft=h("Waiting"),Nt=h("Failed"),St=h("Cancelled"),It=h("Complete"),Tt=h("Sorry, this file type isn't supported");function kt(e,t,r,n,s,a){const u=O("UploaderProgress");return i(),d("div",Et,[l("div",null,[w(u,{progress:s.progress},null,8,["progress"])]),l("div",Dt,[l("div",Pt,[l("div",Lt,p(r.upload.file.name),1),l("div",Ot,p(a.sizeDisplay)+" MB ",1)]),l("div",wt,[s.state===s.states.WAITING?(i(),d(_,{key:0},[Ft],64)):m("",!0),s.state===s.states.FAILED?(i(),d(_,{key:1},[Nt],64)):m("",!0),s.state===s.states.CANCELLED?(i(),d(_,{key:2},[St],64)):m("",!0),s.state===s.states.COMPLETE?(i(),d(_,{key:3},[It],64)):m("",!0),s.state===s.states.UNSUPPORTED?(i(),d(_,{key:4},[Tt],64)):m("",!0),s.state===s.states.UPLOADING?(i(),d("a",{key:5,href:"#",class:"text-blue-500",onClick:t[0]||(t[0]=P((...D)=>a.cancel&&a.cancel(...D),["prevent"]))}," Cancel ")):m("",!0)])])])}var jt=C(Ut,[["render",kt]]);const Rt={components:{UploaderForm:ht,UploaderFile:jt},props:{options:{required:!1,type:Object,default:()=>Z},handlers:{required:!0,type:Object}},data(){return{uploads:[]}},computed:{currentUploadCount(){return this.uploads.filter(e=>e.uploading).length},completedUploadCount(){return this.uploads.filter(e=>e.complete).length},overallProgress(){let e=this.uploads.filter(t=>!t.cancelled&&!t.failed);return e.length===0?0:parseInt(e.reduce((t,r)=>t+r.progress,0)/e.length)}},methods:{handleUploadChange(e){switch(e.state){case c.UPLOADING:this.uploads=this.uploads.map(t=>(e.id===t.id&&(t.uploading=!0),t));break;case c.COMPLETE:this.uploads=this.uploads.map(t=>(e.id===t.id&&(t.complete=!0,t.uploading=!1),t));break;case c.CANCELLED:this.uploads=this.uploads.map(t=>(e.id===t.id&&(t.cancelled=!0,t.uploading=!1),t));break;case c.FAILED:this.uploads=this.uploads.map(t=>(e.id===t.id&&(t.failed=!0,t.uploading=!1),t));break}},handleUploadProgress(e){this.uploads=this.uploads.map(t=>(e.id===t.id&&(t.progress=e.progress),t))},determineEndpointFor(e){return Xe(this.handlers[e],"endpoint",null)},handleFilesChosen(e){console.log(e),this.uploads.push(...Array.from(e).map(t=>({id:rt(),progress:0,uploading:!1,complete:!1,cancelled:!1,failed:!1,queued:!0,file:t})))}},mounted(){setInterval(()=>{if(this.currentUploadCount>=this.options.maxConcurrentUploads)return;let e=this.uploads.filter(t=>t.queued===!0);e.length&&(e[0].queued=!1)},1e3)}},At={class:"mb-4 flex justify-between px-4 text-gray-600 text-sm dark:text-gray-100"};function Gt(e,t,r,n,s,a){const u=O("UploaderForm"),D=O("UploaderFile");return i(),d("div",null,[w(u,{onChosen:a.handleFilesChosen},null,8,["onChosen"]),l("div",At,[l("span",null,p(this.uploads.length)+" uploads ("+p(a.currentUploadCount)+" in progress / "+p(a.completedUploadCount)+" complete)",1),l("span",null,p(a.overallProgress)+"% complete",1)]),(i(!0),d(_,null,Y(s.uploads,(j,J)=>(i(),Q(D,{endpoint:a.determineEndpointFor(j.file.type),baseURL:r.options.baseURL,key:J,upload:j,onProgress:a.handleUploadProgress,onChange:a.handleUploadChange},null,8,["endpoint","baseURL","upload","onProgress","onChange"]))),128))])}var Mt=C(Rt,[["render",Gt]]);const $t={class:"max-w-7xl mx-auto mt-10 px-4"},Ht={setup(e){return(t,r)=>(i(),d("div",$t,[w(Mt,{options:{baseURL:"http://localhost:8000/api",maxConcurrentUploads:2},handlers:{"image/jpg":{endpoint:"files"},"image/jpeg":{endpoint:"files"},"image/png":{endpoint:"files"}}})]))}};export{Ht as default};
